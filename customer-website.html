<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ShopHub - Your Online Shopping Destination</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap');
        
        body {
            font-family: 'Inter', sans-serif;
        }
        
        .hero-gradient {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        
        .product-card {
            transition: transform 0.3s, box-shadow 0.3s;
        }
        
        .product-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
        }
        
        .animate-slide-in {
            animation: slideIn 0.5s ease-out;
        }
        
        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .cart-badge {
            position: absolute;
            top: -8px;
            right: -8px;
            background: #ef4444;
            color: white;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 11px;
            font-weight: bold;
        }
    </style>
</head>
<body class="bg-gray-50">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        const API_BASE = {
            products: 'http://localhost:8081/api/products',
            users: 'http://localhost:8082/api/users',
            cart: 'http://localhost:8083/api/cart',
            orders: 'http://localhost:8084/api/orders',
            payments: 'http://localhost:8085/api/payments'
        };

        function App() {
            const [currentPage, setCurrentPage] = useState('home');
            const [isLoggedIn, setIsLoggedIn] = useState(false);
            const [currentUser, setCurrentUser] = useState(null);
            const [products, setProducts] = useState([]);
            const [cart, setCart] = useState([]);
            const [selectedProduct, setSelectedProduct] = useState(null);
            const [searchQuery, setSearchQuery] = useState('');
            const [notification, setNotification] = useState({ show: false, message: '', type: '' });

            useEffect(() => {
                loadProducts();
                // Check if user is already logged in (from localStorage)
                const savedUser = localStorage.getItem('currentUser');
                if (savedUser) {
                    setCurrentUser(JSON.parse(savedUser));
                    setIsLoggedIn(true);
                    loadCart(JSON.parse(savedUser).id);
                }
            }, []);

            const showNotification = (message, type = 'success') => {
                setNotification({ show: true, message, type });
                setTimeout(() => setNotification({ show: false, message: '', type: '' }), 3000);
            };

            const loadProducts = async () => {
                try {
                    const response = await fetch(API_BASE.products);
                    const data = await response.json();
                    // Shuffle products randomly
                    const shuffled = data.sort(() => Math.random() - 0.5);
                    setProducts(shuffled);
                } catch (error) {
                    console.error('Failed to load products:', error);
                }
            };

            const loadCart = async (userId) => {
                try {
                    const response = await fetch(`${API_BASE.cart}/${userId}`);
                    const data = await response.json();
                    setCart(Array.isArray(data) ? data : []);
                } catch (error) {
                    setCart([]);
                }
            };

            const handleLogin = (user) => {
                setCurrentUser(user);
                setIsLoggedIn(true);
                localStorage.setItem('currentUser', JSON.stringify(user));
                loadCart(user.id);
                setCurrentPage('home');
                showNotification(`Welcome back, ${user.firstName}!`, 'success');
            };

            const handleLogout = () => {
                setCurrentUser(null);
                setIsLoggedIn(false);
                setCart([]);
                localStorage.removeItem('currentUser');
                setCurrentPage('home');
                showNotification('Logged out successfully', 'info');
            };

            const addToCart = async (product) => {
                if (!isLoggedIn) {
                    showNotification('Please login to add items to cart', 'warning');
                    setCurrentPage('login');
                    return;
                }

                try {
                    const response = await fetch(`${API_BASE.cart}/${currentUser.id}/items`, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({
                            productId: product.id,
                            quantity: 1,
                            price: product.price
                        })
                    });
                    const data = await response.json();
                    setCart([...cart, data]);
                    showNotification(`${product.name} added to cart!`, 'success');
                } catch (error) {
                    showNotification('Failed to add to cart', 'error');
                }
            };

            const cartItemCount = cart.reduce((sum, item) => sum + item.quantity, 0);
            const cartTotal = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);

            const filteredProducts = products.filter(product =>
                product.name.toLowerCase().includes(searchQuery.toLowerCase()) ||
                product.category?.toLowerCase().includes(searchQuery.toLowerCase()) ||
                product.brand?.toLowerCase().includes(searchQuery.toLowerCase())
            );

            return (
                <div className="min-h-screen">
                    {/* Notification */}
                    {notification.show && (
                        <div className="fixed top-4 right-4 z-50 animate-slide-in">
                            <div className={`px-6 py-3 rounded-lg shadow-lg ${
                                notification.type === 'success' ? 'bg-green-500' :
                                notification.type === 'error' ? 'bg-red-500' :
                                notification.type === 'warning' ? 'bg-yellow-500' :
                                'bg-blue-500'
                            } text-white font-medium`}>
                                {notification.message}
                            </div>
                        </div>
                    )}

                    {/* Header */}
                    <header className="bg-white shadow-md sticky top-0 z-40">
                        <div className="max-w-7xl mx-auto px-4 py-4">
                            <div className="flex items-center justify-between">
                                {/* Logo */}
                                <div className="flex items-center space-x-8">
                                    <h1 
                                        className="text-3xl font-bold bg-gradient-to-r from-purple-600 to-pink-600 bg-clip-text text-transparent cursor-pointer"
                                        onClick={() => setCurrentPage('home')}
                                    >
                                        üõçÔ∏è ShopHub
                                    </h1>
                                    
                                    {/* Search Bar */}
                                    <div className="hidden md:flex items-center bg-gray-100 rounded-full px-4 py-2 w-96">
                                        <input
                                            type="text"
                                            placeholder="Search for products, brands and more..."
                                            className="bg-transparent outline-none w-full text-sm"
                                            value={searchQuery}
                                            onChange={(e) => setSearchQuery(e.target.value)}
                                        />
                                        <svg className="w-5 h-5 text-gray-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
                                        </svg>
                                    </div>
                                </div>

                                {/* Right Menu */}
                                <div className="flex items-center space-x-6">
                                    {isLoggedIn ? (
                                        <>
                                            <div className="flex items-center space-x-2">
                                                <div className="w-8 h-8 bg-purple-100 rounded-full flex items-center justify-center">
                                                    <span className="text-sm font-semibold text-purple-600">
                                                        {currentUser.firstName[0]}
                                                    </span>
                                                </div>
                                                <span className="text-sm font-medium">{currentUser.firstName}</span>
                                            </div>
                                            
                                            <button
                                                onClick={() => setCurrentPage('orders')}
                                                className="text-sm font-medium hover:text-purple-600"
                                            >
                                                Orders
                                            </button>
                                            
                                            <button
                                                onClick={() => setCurrentPage('cart')}
                                                className="relative"
                                            >
                                                <svg className="w-6 h-6 text-gray-700 hover:text-purple-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.184 1.707.707 1.707H17m0 0a2 2 0 100 4 2 2 0 000-4zm-8 2a2 2 0 11-4 0 2 2 0 014 0z" />
                                                </svg>
                                                {cartItemCount > 0 && <span className="cart-badge">{cartItemCount}</span>}
                                            </button>
                                            
                                            <button
                                                onClick={handleLogout}
                                                className="px-4 py-2 bg-gray-200 hover:bg-gray-300 rounded-lg text-sm font-medium"
                                            >
                                                Logout
                                            </button>
                                        </>
                                    ) : (
                                        <>
                                            <button
                                                onClick={() => setCurrentPage('login')}
                                                className="px-6 py-2 bg-white border-2 border-purple-600 text-purple-600 rounded-lg font-medium hover:bg-purple-50"
                                            >
                                                Login
                                            </button>
                                            <button
                                                onClick={() => setCurrentPage('register')}
                                                className="px-6 py-2 bg-purple-600 text-white rounded-lg font-medium hover:bg-purple-700"
                                            >
                                                Sign Up
                                            </button>
                                        </>
                                    )}
                                </div>
                            </div>
                        </div>
                    </header>

                    {/* Main Content */}
                    <main>
                        {currentPage === 'home' && (
                            <HomePage 
                                products={filteredProducts}
                                addToCart={addToCart}
                                setSelectedProduct={setSelectedProduct}
                                setCurrentPage={setCurrentPage}
                            />
                        )}
                        {currentPage === 'login' && <LoginPage onLogin={handleLogin} setCurrentPage={setCurrentPage} />}
                        {currentPage === 'register' && <RegisterPage setCurrentPage={setCurrentPage} showNotification={showNotification} />}
                        {currentPage === 'cart' && <CartPage cart={cart} setCart={setCart} currentUser={currentUser} showNotification={showNotification} />}
                        {currentPage === 'orders' && <OrdersPage currentUser={currentUser} />}
                        {currentPage === 'product' && selectedProduct && (
                            <ProductDetailPage 
                                product={selectedProduct}
                                addToCart={addToCart}
                                setCurrentPage={setCurrentPage}
                            />
                        )}
                    </main>

                    {/* Footer */}
                    <footer className="bg-gray-900 text-white py-12 mt-20">
                        <div className="max-w-7xl mx-auto px-4">
                            <div className="grid grid-cols-1 md:grid-cols-4 gap-8">
                                <div>
                                    <h3 className="text-xl font-bold mb-4">ShopHub</h3>
                                    <p className="text-gray-400 text-sm">Your trusted online shopping destination</p>
                                </div>
                                <div>
                                    <h4 className="font-semibold mb-4">Shop</h4>
                                    <ul className="space-y-2 text-sm text-gray-400">
                                        <li>Electronics</li>
                                        <li>Fashion</li>
                                        <li>Home & Kitchen</li>
                                        <li>Books</li>
                                    </ul>
                                </div>
                                <div>
                                    <h4 className="font-semibold mb-4">Help</h4>
                                    <ul className="space-y-2 text-sm text-gray-400">
                                        <li>Contact Us</li>
                                        <li>Track Order</li>
                                        <li>Returns</li>
                                        <li>FAQs</li>
                                    </ul>
                                </div>
                                <div>
                                    <h4 className="font-semibold mb-4">Follow Us</h4>
                                    <div className="flex space-x-4">
                                        <div className="w-8 h-8 bg-gray-700 rounded-full"></div>
                                        <div className="w-8 h-8 bg-gray-700 rounded-full"></div>
                                        <div className="w-8 h-8 bg-gray-700 rounded-full"></div>
                                    </div>
                                </div>
                            </div>
                            <div className="border-t border-gray-800 mt-8 pt-8 text-center text-gray-400 text-sm">
                                ¬© 2025 ShopHub. All rights reserved. | Powered by Spring Boot Microservices
                            </div>
                        </div>
                    </footer>
                </div>
            );
        }

        function HomePage({ products, addToCart, setSelectedProduct, setCurrentPage }) {
            const categories = [...new Set(products.map(p => p.category).filter(Boolean))];

            return (
                <div>
                    {/* Hero Banner */}
                    <div className="hero-gradient text-white py-20">
                        <div className="max-w-7xl mx-auto px-4 text-center">
                            <h2 className="text-5xl font-bold mb-4">Welcome to ShopHub</h2>
                            <p className="text-xl mb-8">Discover amazing products at unbeatable prices</p>
                            <button className="px-8 py-3 bg-white text-purple-600 rounded-full font-semibold text-lg hover:bg-gray-100">
                                Shop Now
                            </button>
                        </div>
                    </div>

                    {/* Categories */}
                    {categories.length > 0 && (
                        <div className="max-w-7xl mx-auto px-4 py-8">
                            <h3 className="text-2xl font-bold mb-6">Shop by Category</h3>
                            <div className="flex space-x-4 overflow-x-auto pb-4">
                                {categories.map(category => (
                                    <div key={category} className="flex-shrink-0 w-32 h-32 bg-gradient-to-br from-purple-100 to-pink-100 rounded-lg flex items-center justify-center cursor-pointer hover:shadow-lg transition">
                                        <span className="text-center font-semibold text-sm">{category}</span>
                                    </div>
                                ))}
                            </div>
                        </div>
                    )}

                    {/* Products Grid */}
                    <div className="max-w-7xl mx-auto px-4 py-8">
                        <div className="flex justify-between items-center mb-6">
                            <h3 className="text-2xl font-bold">All Products</h3>
                            <span className="text-gray-600">{products.length} items</span>
                        </div>

                        {products.length === 0 ? (
                            <div className="text-center py-20">
                                <div className="text-6xl mb-4">üì¶</div>
                                <p className="text-xl text-gray-600 mb-2">No products available</p>
                                <p className="text-gray-400">Check back later for new arrivals</p>
                            </div>
                        ) : (
                            <div className="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6">
                                {products.map(product => (
                                    <div key={product.id} className="product-card bg-white rounded-lg overflow-hidden shadow-md">
                                        <div 
                                            className="h-48 bg-gray-200 cursor-pointer relative overflow-hidden"
                                            onClick={() => {
                                                setSelectedProduct(product);
                                                setCurrentPage('product');
                                            }}
                                        >
                                            {product.imageUrl ? (
                                                <img src={product.imageUrl} alt={product.name} className="w-full h-full object-cover" />
                                            ) : (
                                                <div className="w-full h-full flex items-center justify-center text-6xl">
                                                    üì¶
                                                </div>
                                            )}
                                            {product.stockQuantity < 10 && (
                                                <span className="absolute top-2 right-2 px-2 py-1 bg-red-500 text-white text-xs rounded">
                                                    Only {product.stockQuantity} left
                                                </span>
                                            )}
                                        </div>
                                        <div className="p-4">
                                            <div className="text-xs text-gray-500 mb-1">{product.brand}</div>
                                            <h4 className="font-semibold mb-2 line-clamp-2 h-12">{product.name}</h4>
                                            <div className="flex items-center mb-3">
                                                <span className="text-2xl font-bold text-green-600">${product.price}</span>
                                            </div>
                                            <button
                                                onClick={() => addToCart(product)}
                                                className="w-full py-2 bg-purple-600 text-white rounded-lg font-medium hover:bg-purple-700 transition"
                                            >
                                                Add to Cart
                                            </button>
                                        </div>
                                    </div>
                                ))}
                            </div>
                        )}
                    </div>
                </div>
            );
        }

        function LoginPage({ onLogin, setCurrentPage }) {
            const [email, setEmail] = useState('');
            const [password, setPassword] = useState('');
            const [error, setError] = useState('');
            const [loading, setLoading] = useState(false);

            const handleSubmit = async (e) => {
                e.preventDefault();
                setError('');
                setLoading(true);

                try {
                    const response = await fetch(`${API_BASE.users}/email/${email}`);
                    if (response.ok) {
                        const user = await response.json();
                        // In real app, verify password on backend
                        onLogin(user);
                    } else {
                        setError('Invalid email or password');
                    }
                } catch (err) {
                    setError('Login failed. Please try again.');
                }
                setLoading(false);
            };

            return (
                <div className="min-h-screen flex items-center justify-center py-12 px-4">
                    <div className="max-w-md w-full">
                        <div className="bg-white rounded-2xl shadow-xl p-8">
                            <h2 className="text-3xl font-bold text-center mb-2">Welcome Back</h2>
                            <p className="text-center text-gray-600 mb-8">Login to continue shopping</p>

                            {error && (
                                <div className="mb-4 p-3 bg-red-100 text-red-700 rounded-lg text-sm">
                                    {error}
                                </div>
                            )}

                            <form onSubmit={handleSubmit} className="space-y-4">
                                <div>
                                    <label className="block text-sm font-medium mb-2">Email</label>
                                    <input
                                        type="email"
                                        value={email}
                                        onChange={(e) => setEmail(e.target.value)}
                                        className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-600 focus:border-transparent"
                                        placeholder="your@email.com"
                                        required
                                    />
                                </div>

                                <div>
                                    <label className="block text-sm font-medium mb-2">Password</label>
                                    <input
                                        type="password"
                                        value={password}
                                        onChange={(e) => setPassword(e.target.value)}
                                        className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-600 focus:border-transparent"
                                        placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢"
                                        required
                                    />
                                </div>

                                <button
                                    type="submit"
                                    disabled={loading}
                                    className="w-full py-3 bg-purple-600 text-white rounded-lg font-semibold hover:bg-purple-700 disabled:opacity-50"
                                >
                                    {loading ? 'Logging in...' : 'Login'}
                                </button>
                            </form>

                            <p className="text-center mt-6 text-sm text-gray-600">
                                Don't have an account?{' '}
                                <button
                                    onClick={() => setCurrentPage('register')}
                                    className="text-purple-600 font-semibold hover:underline"
                                >
                                    Sign Up
                                </button>
                            </p>
                        </div>
                    </div>
                </div>
            );
        }

        function RegisterPage({ setCurrentPage, showNotification }) {
            const [formData, setFormData] = useState({
                firstName: '',
                lastName: '',
                email: '',
                password: '',
                phoneNumber: '',
                role: 'CUSTOMER'
            });
            const [loading, setLoading] = useState(false);

            const handleSubmit = async (e) => {
                e.preventDefault();
                setLoading(true);

                try {
                    const response = await fetch(API_BASE.users, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(formData)
                    });
                    
                    if (response.ok) {
                        showNotification('Account created successfully! Please login.', 'success');
                        setCurrentPage('login');
                    } else {
                        showNotification('Registration failed. Email may already exist.', 'error');
                    }
                } catch (error) {
                    showNotification('Registration failed. Please try again.', 'error');
                }
                setLoading(false);
            };

            return (
                <div className="min-h-screen flex items-center justify-center py-12 px-4">
                    <div className="max-w-md w-full">
                        <div className="bg-white rounded-2xl shadow-xl p-8">
                            <h2 className="text-3xl font-bold text-center mb-2">Create Account</h2>
                            <p className="text-center text-gray-600 mb-8">Join us for amazing deals</p>

                            <form onSubmit={handleSubmit} className="space-y-4">
                                <div className="grid grid-cols-2 gap-4">
                                    <div>
                                        <label className="block text-sm font-medium mb-2">First Name</label>
                                        <input
                                            type="text"
                                            value={formData.firstName}
                                            onChange={(e) => setFormData({...formData, firstName: e.target.value})}
                                            className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-600"
                                            required
                                        />
                                    </div>
                                    <div>
                                        <label className="block text-sm font-medium mb-2">Last Name</label>
                                        <input
                                            type="text"
                                            value={formData.lastName}
                                            onChange={(e) => setFormData({...formData, lastName: e.target.value})}
                                            className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-600"
                                            required
                                        />
                                    </div>
                                </div>

                                <div>
                                    <label className="block text-sm font-medium mb-2">Email</label>
                                    <input
                                        type="email"
                                        value={formData.email}
                                        onChange={(e) => setFormData({...formData, email: e.target.value})}
                                        className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-600"
                                        required
                                    />
                                </div>

                                <div>
                                    <label className="block text-sm font-medium mb-2">Password</label>
                                    <input
                                        type="password"
                                        value={formData.password}
                                        onChange={(e) => setFormData({...formData, password: e.target.value})}
                                        className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-600"
                                        required
                                    />
                                </div>

                                <div>
                                    <label className="block text-sm font-medium mb-2">Phone Number</label>
                                    <input
                                        type="tel"
                                        value={formData.phoneNumber}
                                        onChange={(e) => setFormData({...formData, phoneNumber: e.target.value})}
                                        className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-600"
                                    />
                                </div>

                                <button
                                    type="submit"
                                    disabled={loading}
                                    className="w-full py-3 bg-purple-600 text-white rounded-lg font-semibold hover:bg-purple-700 disabled:opacity-50"
                                >
                                    {loading ? 'Creating Account...' : 'Sign Up'}
                                </button>
                            </form>

                            <p className="text-center mt-6 text-sm text-gray-600">
                                Already have an account?{' '}
                                <button
                                    onClick={() => setCurrentPage('login')}
                                    className="text-purple-600 font-semibold hover:underline"
                                >
                                    Login
                                </button>
                            </p>
                        </div>
                    </div>
                </div>
            );
        }

        function CartPage({ cart, setCart, currentUser, showNotification }) {
            const removeFromCart = async (itemId) => {
                try {
                    await fetch(`${API_BASE.cart}/items/${itemId}`, { method: 'DELETE' });
                    setCart(cart.filter(item => item.id !== itemId));
                    showNotification('Item removed from cart', 'info');
                } catch (error) {
                    showNotification('Failed to remove item', 'error');
                }
            };

            const updateQuantity = async (item, newQuantity) => {
                if (newQuantity < 1) return;
                try {
                    const response = await fetch(`${API_BASE.cart}/items/${item.id}`, {
                        method: 'PUT',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ ...item, quantity: newQuantity })
                    });
                    const updated = await response.json();
                    setCart(cart.map(i => i.id === item.id ? updated : i));
                } catch (error) {
                    showNotification('Failed to update quantity', 'error');
                }
            };

            const total = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);

            if (cart.length === 0) {
                return (
                    <div className="max-w-7xl mx-auto px-4 py-20 text-center">
                        <div className="text-8xl mb-6">üõí</div>
                        <h2 className="text-3xl font-bold mb-4">Your cart is empty</h2>
                        <p className="text-gray-600 mb-8">Add some products to get started</p>
                    </div>
                );
            }

            return (
                <div className="max-w-7xl mx-auto px-4 py-8">
                    <h2 className="text-3xl font-bold mb-8">Shopping Cart ({cart.length} items)</h2>

                    <div className="grid grid-cols-1 lg:grid-cols-3 gap-8">
                        <div className="lg:col-span-2 space-y-4">
                            {cart.map(item => (
                                <div key={item.id} className="bg-white rounded-lg p-6 shadow-md flex gap-6">
                                    <div className="w-24 h-24 bg-gray-200 rounded flex-shrink-0 flex items-center justify-center text-3xl">
                                        üì¶
                                    </div>
                                    <div className="flex-1">
                                        <h3 className="font-semibold text-lg mb-2">Product ID: {item.productId}</h3>
                                        <p className="text-green-600 font-bold text-xl mb-4">${item.price}</p>
                                        <div className="flex items-center gap-4">
                                            <div className="flex items-center border rounded">
                                                <button
                                                    onClick={() => updateQuantity(item, item.quantity - 1)}
                                                    className="px-3 py-1 hover:bg-gray-100"
                                                >
                                                    -
                                                </button>
                                                <span className="px-4 py-1 border-x">{item.quantity}</span>
                                                <button
                                                    onClick={() => updateQuantity(item, item.quantity + 1)}
                                                    className="px-3 py-1 hover:bg-gray-100"
                                                >
                                                    +
                                                </button>
                                            </div>
                                            <button
                                                onClick={() => removeFromCart(item.id)}
                                                className="text-red-600 hover:text-red-700 font-medium"
                                            >
                                                Remove
                                            </button>
                                        </div>
                                    </div>
                                    <div className="text-right">
                                        <p className="text-xl font-bold">${(item.price * item.quantity).toFixed(2)}</p>
                                    </div>
                                </div>
                            ))}
                        </div>

                        <div className="lg:col-span-1">
                            <div className="bg-white rounded-lg p-6 shadow-md sticky top-24">
                                <h3 className="text-xl font-bold mb-4">Order Summary</h3>
                                <div className="space-y-3 mb-6">
                                    <div className="flex justify-between">
                                        <span>Subtotal</span>
                                        <span className="font-semibold">${total.toFixed(2)}</span>
                                    </div>
                                    <div className="flex justify-between">
                                        <span>Shipping</span>
                                        <span className="font-semibold">FREE</span>
                                    </div>
                                    <div className="border-t pt-3 flex justify-between text-xl font-bold">
                                        <span>Total</span>
                                        <span className="text-green-600">${total.toFixed(2)}</span>
                                    </div>
                                </div>
                                <button className="w-full py-3 bg-purple-600 text-white rounded-lg font-semibold hover:bg-purple-700 mb-3">
                                    Proceed to Checkout
                                </button>
                                <p className="text-xs text-gray-500 text-center">
                                    Free delivery on orders above $50
                                </p>
                            </div>
                        </div>
                    </div>
                </div>
            );
        }

        function OrdersPage({ currentUser }) {
            const [orders, setOrders] = useState([]);

            useEffect(() => {
                if (currentUser) {
                    fetch(`${API_BASE.orders}/user/${currentUser.id}`)
                        .then(res => res.json())
                        .then(data => setOrders(Array.isArray(data) ? data : []))
                        .catch(() => setOrders([]));
                }
            }, [currentUser]);

            return (
                <div className="max-w-7xl mx-auto px-4 py-8">
                    <h2 className="text-3xl font-bold mb-8">My Orders</h2>

                    {orders.length === 0 ? (
                        <div className="text-center py-20">
                            <div className="text-8xl mb-6">üì¶</div>
                            <h3 className="text-2xl font-bold mb-4">No orders yet</h3>
                            <p className="text-gray-600">Your order history will appear here</p>
                        </div>
                    ) : (
                        <div className="space-y-4">
                            {orders.map(order => (
                                <div key={order.id} className="bg-white rounded-lg p-6 shadow-md">
                                    <div className="flex justify-between items-start mb-4">
                                        <div>
                                            <h3 className="font-bold text-lg">Order #{order.id}</h3>
                                            <p className="text-sm text-gray-600">
                                                {new Date(order.createdAt).toLocaleDateString()}
                                            </p>
                                        </div>
                                        <span className={`px-4 py-2 rounded-full font-medium ${
                                            order.status === 'DELIVERED' ? 'bg-green-100 text-green-700' :
                                            order.status === 'SHIPPED' ? 'bg-blue-100 text-blue-700' :
                                            order.status === 'CANCELLED' ? 'bg-red-100 text-red-700' :
                                            'bg-yellow-100 text-yellow-700'
                                        }`}>
                                            {order.status}
                                        </span>
                                    </div>
                                    <p className="text-2xl font-bold text-green-600 mb-2">${order.totalAmount}</p>
                                    <p className="text-sm text-gray-600">{order.shippingAddress}</p>
                                </div>
                            ))}
                        </div>
                    )}
                </div>
            );
        }

        function ProductDetailPage({ product, addToCart, setCurrentPage }) {
            return (
                <div className="max-w-7xl mx-auto px-4 py-8">
                    <button
                        onClick={() => setCurrentPage('home')}
                        className="mb-6 flex items-center text-purple-600 hover:text-purple-700"
                    >
                        <svg className="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M15 19l-7-7 7-7" />
                        </svg>
                        Back to products
                    </button>

                    <div className="grid grid-cols-1 md:grid-cols-2 gap-12">
                        <div>
                            <div className="bg-gray-200 rounded-lg h-96 flex items-center justify-center">
                                {product.imageUrl ? (
                                    <img src={product.imageUrl} alt={product.name} className="max-h-full" />
                                ) : (
                                    <span className="text-9xl">üì¶</span>
                                )}
                            </div>
                        </div>

                        <div>
                            <div className="text-sm text-gray-500 mb-2">{product.brand}</div>
                            <h1 className="text-4xl font-bold mb-4">{product.name}</h1>
                            <div className="text-4xl font-bold text-green-600 mb-6">${product.price}</div>
                            
                            <div className="mb-6">
                                <span className={`px-3 py-1 rounded-full text-sm ${
                                    product.stockQuantity > 20 ? 'bg-green-100 text-green-700' :
                                    product.stockQuantity > 0 ? 'bg-yellow-100 text-yellow-700' :
                                    'bg-red-100 text-red-700'
                                }`}>
                                    {product.stockQuantity > 0 ? `${product.stockQuantity} in stock` : 'Out of stock'}
                                </span>
                            </div>

                            <p className="text-gray-700 mb-8 leading-relaxed">{product.description}</p>

                            <button
                                onClick={() => addToCart(product)}
                                disabled={product.stockQuantity === 0}
                                className="w-full py-4 bg-purple-600 text-white rounded-lg text-lg font-semibold hover:bg-purple-700 disabled:bg-gray-300 disabled:cursor-not-allowed mb-4"
                            >
                                {product.stockQuantity === 0 ? 'Out of Stock' : 'Add to Cart'}
                            </button>

                            <div className="border-t pt-6 space-y-4">
                                <div className="flex justify-between">
                                    <span className="text-gray-600">Category</span>
                                    <span className="font-semibold">{product.category}</span>
                                </div>
                                <div className="flex justify-between">
                                    <span className="text-gray-600">Brand</span>
                                    <span className="font-semibold">{product.brand}</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            );
        }

        ReactDOM.render(<App />, document.getElementById('root'));
    </script>
</body>
</html>